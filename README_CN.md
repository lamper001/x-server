# ğŸš€ X-Server é«˜æ€§èƒ½å¤šè¿›ç¨‹WebæœåŠ¡å™¨

[![Build Status](https://img.shields.io/badge/build-passing-brightgreen.svg)](https://github.com/lamper001/x-server)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-2.0.0-orange.svg)](CHANGELOG.md)

[English](README.md) | ä¸­æ–‡

X-Serveræ˜¯ä¸€ä¸ªç”¨çº¯Cè¯­è¨€å¼€å‘çš„**é«˜æ€§èƒ½ã€å¤šè¿›ç¨‹WebæœåŠ¡å™¨å’Œåå‘ä»£ç†ç½‘å…³**ï¼Œé‡‡ç”¨ç±»ä¼¼nginxçš„Master-Workeræ¶æ„è®¾è®¡ï¼Œå…·æœ‰å“è¶Šçš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ—ï¸ å¤šè¿›ç¨‹æ¶æ„
- **Master-Workeræ¨¡å‹**ï¼šMasterè¿›ç¨‹ç®¡ç†é…ç½®å’ŒWorkerè¿›ç¨‹ï¼ŒWorkerè¿›ç¨‹å¤„ç†å®é™…è¯·æ±‚
- **è¿›ç¨‹éš”ç¦»**ï¼šWorkerè¿›ç¨‹ç‹¬ç«‹è¿è¡Œï¼Œå•ä¸ªè¿›ç¨‹å´©æºƒä¸å½±å“æ•´ä½“æœåŠ¡
- **è‡ªåŠ¨é‡å¯**ï¼šMasterè¿›ç¨‹ç›‘æ§Workerè¿›ç¨‹ï¼Œå¼‚å¸¸é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯
- **ä¼˜é›…å…³é—­**ï¼šæ”¯æŒä¼˜é›…å…³é—­å’Œé‡å¯ï¼Œä¸ä¸¢å¤±æ­£åœ¨å¤„ç†çš„è¯·æ±‚
- **é…ç½®çƒ­é‡è½½**ï¼šè¿è¡Œæ—¶é‡æ–°åŠ è½½é…ç½®ï¼Œæ— éœ€é‡å¯æœåŠ¡

### âš¡ é«˜æ€§èƒ½ä¼˜åŒ–
- **äº‹ä»¶é©±åŠ¨I/O**ï¼šåŸºäºepoll(Linux)/kqueue(macOS)çš„é«˜æ€§èƒ½å¼‚æ­¥I/O
- **é›¶æ‹·è´ä¼ è¾“**ï¼šé™æ€æ–‡ä»¶ä½¿ç”¨sendfile/mmapä¼˜åŒ–ä¼ è¾“
- **è¿æ¥æ± ç®¡ç†**ï¼šè¿æ¥å¯¹è±¡å¤ç”¨ï¼Œå‡å°‘å†…å­˜åˆ†é…å¼€é”€
- **å†…å­˜æ± ä¼˜åŒ–**ï¼šåˆ†çº§å†…å­˜æ± ç®¡ç†ï¼Œé¿å…å†…å­˜ç¢ç‰‡
- **TLSæ—¥å¿—ä¼˜åŒ–**ï¼šçº¿ç¨‹æœ¬åœ°ç¼“å†²åŒºå‡å°‘é”ç«äº‰ï¼Œæ‰¹é‡å†™å…¥æå‡æ€§èƒ½

### ğŸŒ ç½‘ç»œåŠŸèƒ½
- **HTTP/1.1æ”¯æŒ**ï¼šå®Œæ•´çš„HTTPåè®®å®ç°ï¼Œæ”¯æŒKeep-Alive
- **åå‘ä»£ç†**ï¼šé«˜æ€§èƒ½HTTPè¯·æ±‚è½¬å‘å’Œè´Ÿè½½å‡è¡¡
- **é™æ€æ–‡ä»¶æœåŠ¡**ï¼šå†…ç½®é«˜æ€§èƒ½æ–‡ä»¶æœåŠ¡å™¨ï¼Œæ”¯æŒç›®å½•æµè§ˆ
- **è·¯ç”±ç³»ç»Ÿ**ï¼šçµæ´»çš„è·¯ç”±é…ç½®ï¼Œæ”¯æŒå‰ç¼€åŒ¹é…å’Œç²¾ç¡®åŒ¹é…
- **MIMEç±»å‹**ï¼šæ”¯æŒ24ç§å¸¸è§æ–‡ä»¶ç±»å‹çš„è‡ªåŠ¨è¯†åˆ«

### ğŸ”’ è®¤è¯ä¸å®‰å…¨
- **Tokenè®¤è¯**ï¼šæ”¯æŒç®€å•çš„TokenéªŒè¯æœºåˆ¶
- **OAuthè®¤è¯**ï¼šæ”¯æŒOAuthæ ‡å‡†è®¤è¯æµç¨‹
- **è·¯å¾„å®‰å…¨**ï¼šé˜²æ­¢è·¯å¾„éå†æ”»å‡»ï¼ŒçœŸå®è·¯å¾„éªŒè¯
- **è¯·æ±‚éªŒè¯**ï¼šè¯·æ±‚å¤§å°é™åˆ¶ã€è¶…æ—¶ä¿æŠ¤ã€è¿æ¥æ•°é™åˆ¶

### ğŸ“Š æ—¥å¿—ä¸ç›‘æ§
- **é«˜æ€§èƒ½æ—¥å¿—**ï¼šTLSä¼˜åŒ–çš„æ—¥å¿—ç³»ç»Ÿï¼Œæ”¯æŒ161ä¸‡+æ—¥å¿—/ç§’
- **è®¿é—®æ—¥å¿—**ï¼šApacheé£æ ¼çš„è®¿é—®æ—¥å¿—è®°å½•
- **ç³»ç»Ÿæ—¥å¿—**ï¼šè¯¦ç»†çš„æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯
- **æ—¥å¿—åˆ‡åˆ†**ï¼šæ”¯æŒæŒ‰å¤©è‡ªåŠ¨åˆ‡åˆ†æ—¥å¿—æ–‡ä»¶
- **æ€§èƒ½ç»Ÿè®¡**ï¼šè¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡å’Œç»Ÿè®¡ä¿¡æ¯

## ğŸ› ï¸ ç¼–è¯‘å®‰è£…

### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**ï¼šLinuxã€macOSã€BSD
- **ç¼–è¯‘å™¨**ï¼šGCC 4.9+ æˆ– Clang 3.5+
- **ä¾èµ–åº“**ï¼špthreadã€mathåº“ï¼ˆç³»ç»Ÿè‡ªå¸¦ï¼‰

### å¿«é€Ÿç¼–è¯‘
```bash
# å…‹éš†é¡¹ç›®
git clone git@github.com:lamper001/x-server.git
cd x-server

# ç¼–è¯‘å¤šè¿›ç¨‹ç‰ˆæœ¬
make

# æµ‹è¯•é…ç½®æ–‡ä»¶
make test

# è¿è¡ŒæœåŠ¡å™¨ï¼ˆå‰å°æ¨¡å¼ï¼‰
make run
```

### ç¼–è¯‘é€‰é¡¹
```bash
# æ¸…ç†ç¼–è¯‘æ–‡ä»¶
make clean

# ç¼–è¯‘è°ƒè¯•ç‰ˆæœ¬
make debug

# ç¼–è¯‘å‘å¸ƒç‰ˆæœ¬
make release

# å®‰è£…åˆ°ç³»ç»Ÿç›®å½•
sudo make install

# å¸è½½
sudo make uninstall
```

### æœåŠ¡ç®¡ç†
```bash
# å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹
make daemon

# åœæ­¢æœåŠ¡å™¨
make stop

# é‡æ–°åŠ è½½é…ç½®
make reload

# æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€
make status
```

## âš™ï¸ é…ç½®è¯´æ˜

### å¤šè¿›ç¨‹é…ç½®ç³»ç»Ÿ

X-Serveré‡‡ç”¨nginxé£æ ¼çš„é…ç½®æ–‡ä»¶æ ¼å¼ï¼Œä½†æ˜¯æ›´ç®€æ´ï¼Œæ”¯æŒå¤šè¿›ç¨‹æ¶æ„çš„å„ç§ä¼˜åŒ–å‚æ•°ã€‚

#### åŸºæœ¬é…ç½®ç¤ºä¾‹

åˆ›å»ºé…ç½®æ–‡ä»¶ `gateway.conf`ï¼š
```nginx
# å…¨å±€é…ç½®
worker_processes auto;              # è‡ªåŠ¨æ£€æµ‹CPUæ ¸å¿ƒæ•°
listen_port 9001;                   # ç›‘å¬ç«¯å£

# æ—¥å¿—é…ç½®
log_path logs/                      # æ—¥å¿—ç›®å½•
log_daily 1;                        # æŒ‰æ—¥åˆ†å‰²
log_level 1;                        # INFOçº§åˆ«

# è·¯ç”±é…ç½®
route static / ./public/ none UTF-8                 # é™æ€æ–‡ä»¶æœåŠ¡
route proxy /api/v1/ 127.0.0.1:3001 oauth UTF-8    # APIä»£ç†+OAuth
route proxy /api/v2/ 127.0.0.1:3002 none UTF-8     # APIä»£ç†
route proxy /admin/ 127.0.0.1:3003 token UTF-8     # ç®¡ç†åå°+Tokenè®¤è¯
```

å¯åŠ¨æœåŠ¡å™¨ï¼š
```bash
./bin/x-server -c gateway.conf
```

#### æ€§èƒ½ä¼˜åŒ–é…ç½®

```nginx
# è¿›ç¨‹é…ç½®
worker_processes auto;              # Workerè¿›ç¨‹æ•°ï¼ˆå»ºè®®ç­‰äºCPUæ ¸å¿ƒæ•°ï¼‰
worker_connections 10000;           # æ¯ä¸ªWorkeræœ€å¤§è¿æ¥æ•°
worker_rlimit_nofile 65535;         # æ–‡ä»¶æè¿°ç¬¦é™åˆ¶

# ç½‘ç»œä¼˜åŒ–
tcp_nodelay on;                     # ç¦ç”¨Nagleç®—æ³•
tcp_nopush off;                     # ç¦ç”¨TCP_CORK
keepalive_timeout 65;               # Keep-aliveè¶…æ—¶

# ç¼“å†²åŒºä¼˜åŒ–
client_max_body_size 10m;           # æœ€å¤§è¯·æ±‚ä½“
client_header_buffer_size 1k;       # è¯·æ±‚å¤´ç¼“å†²åŒº
client_body_buffer_size 128k;       # è¯·æ±‚ä½“ç¼“å†²åŒº

# å†…å­˜æ± é…ç½®
memory_pool_size 100m;              # æ¯ä¸ªWorkerå†…å­˜æ± å¤§å°
connection_pool_size 1000;          # è¿æ¥æ± å¤§å°
```

#### é…ç½®å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | æ¨èå€¼ |
|------|------|--------|--------|
| worker_processes | Workerè¿›ç¨‹æ•°é‡ | auto | autoæˆ–CPUæ ¸å¿ƒæ•° |
| listen_port | ç›‘å¬ç«¯å£ | 9001 | æ ¹æ®éœ€è¦è®¾ç½® |
| log_level | æ—¥å¿—çº§åˆ«(0-3) | 1 | ç”Ÿäº§ç¯å¢ƒå»ºè®®2 |
| worker_connections | æ¯Workeræœ€å¤§è¿æ¥æ•° | 1024 | 10000+ |

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

**1. å¯åŠ¨æœåŠ¡å™¨**
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨
./bin/x-server

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®å¯åŠ¨
./bin/x-server -c config/gateway.conf

# åå°è¿è¡Œ
./bin/x-server -c config/gateway.conf -d
```

**2. æµ‹è¯•æœåŠ¡å™¨**
```bash
# æµ‹è¯•é™æ€æ–‡ä»¶æœåŠ¡
curl http://localhost:9001/

# æµ‹è¯•ä»£ç†è½¬å‘
curl http://localhost:9001/api/v1/users

# æµ‹è¯•è®¤è¯
curl -H "Authorization: Bearer your-token" http://localhost:9001/admin/
```

### é«˜çº§ä½¿ç”¨

**1. é…ç½®çƒ­é‡è½½**
```bash
# å‘é€SIGHUPä¿¡å·é‡è½½é…ç½®
kill -HUP $(cat x-server.pid)

# æˆ–ä½¿ç”¨ç®¡ç†å‘½ä»¤
./bin/x-server-mp -s reload
```

**2. ä¼˜é›…å…³é—­**
```bash
# ä¼˜é›…å…³é—­æœåŠ¡å™¨
./bin/x-server -s quit

# å¼ºåˆ¶å…³é—­
./bin/x-server -s stop
```

**3. é…ç½®æµ‹è¯•**
```bash
# æµ‹è¯•é…ç½®æ–‡ä»¶è¯­æ³•
./bin/x-server -t -c config/gateway.conf
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

**1. ç³»ç»ŸæœåŠ¡é…ç½®**
```bash
# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
sudo tee /etc/systemd/system/x-server.service << EOF
[Unit]
Description=X-Server High Performance Web Server
After=network.target

[Service]
Type=forking
User=www-data
Group=www-data
ExecStart=/usr/local/bin/x-server-mp -c /etc/x-server/gateway.conf -d
ExecReload=/bin/kill -HUP \$MAINPID
KillMode=mixed
KillSignal=SIGQUIT
TimeoutStopSec=5
PrivateTmp=true

[Install]
WantedBy=multi-user.target
EOF

# å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡
sudo systemctl enable x-server
sudo systemctl start x-server
```

**2. æ—¥å¿—è½®è½¬é…ç½®**
```bash
# åˆ›å»ºlogrotateé…ç½®
sudo tee /etc/logrotate.d/x-server << EOF
/var/log/x-server/*.log {
    daily
    missingok
    rotate 52
    compress
    delaycompress
    notifempty
    create 644 www-data www-data
    postrotate
        /bin/kill -USR1 \$(cat /var/run/x-server.pid 2>/dev/null) 2>/dev/null || true
    endscript
}
EOF
```

## ğŸ“Š æ€§èƒ½åŸºå‡†

### HTTPæœåŠ¡æ€§èƒ½
- **å¹¶å‘å¤„ç†**: **10,000 å¹¶å‘è¿æ¥** ç¨³å®šå¤„ç†
- **è¯·æ±‚ååé‡**: **4,468 RPS** (æ¯ç§’è¯·æ±‚æ•°)
- **å“åº”æ—¶é—´**: 
  - å¹³å‡å“åº”æ—¶é—´: **223.8ms**
  - 50%è¯·æ±‚å“åº”æ—¶é—´: **215ms**
  - 99%è¯·æ±‚å“åº”æ—¶é—´: **1,785ms**
- **ä¼ è¾“é€Ÿç‡**: **16,774 KB/s** (16MB/s)
- **è¿æ¥å¤„ç†**: æ”¯æŒ10,000å¹¶å‘è¿æ¥ï¼Œé›¶å¤±è´¥ç‡

### æ—¥å¿—ç³»ç»Ÿæ€§èƒ½
- **ååé‡**: **1,617,408 æ—¥å¿—/ç§’** (161ä¸‡+/ç§’)
- **å»¶è¿Ÿ**: **0.618 å¾®ç§’/æ¡** (äºšå¾®ç§’çº§)
- **å†…å­˜ä½¿ç”¨**: æ¯çº¿ç¨‹8KB TLSç¼“å†²åŒº
- **CPUæ•ˆç‡**: ç›¸æ¯”å…¨å±€é”æ–¹æ¡ˆé™ä½80%

### äº‹ä»¶å¾ªç¯æ€§èƒ½
- **å¹¶å‘è¿æ¥**: æ”¯æŒ10ä¸‡+è¿æ¥
- **äº‹ä»¶å¤„ç†**: 1000+äº‹ä»¶/æ‰¹æ¬¡
- **å“åº”æ—¶é—´**: äºšæ¯«ç§’çº§å“åº”
- **è·¨å¹³å°**: Linux epoll + macOS kqueueä¼˜åŒ–

### æ–‡ä»¶æœåŠ¡æ€§èƒ½
- **ä¼ è¾“ä¼˜åŒ–**: sendfile + mmapé›¶æ‹·è´æŠ€æœ¯
- **ç¼“å­˜å‘½ä¸­**: çƒ­ç‚¹æ–‡ä»¶90%+å‘½ä¸­ç‡
- **å¹¶å‘æ–‡ä»¶**: æ”¯æŒä¸‡çº§å¹¶å‘æ–‡ä»¶è®¿é—®
- **MIMEæ”¯æŒ**: 24ç§æ–‡ä»¶ç±»å‹è‡ªåŠ¨è¯†åˆ«

### æ€§èƒ½æµ‹è¯•ç¯å¢ƒ
- **æµ‹è¯•å·¥å…·**: ApacheBench (ab)
- **å¹¶å‘è¿æ¥**: 10,000
- **æ€»è¯·æ±‚æ•°**: 10,000
- **æµ‹è¯•æ–‡ä»¶**: 3,689å­—èŠ‚é™æ€HTMLæ–‡ä»¶
- **ç³»ç»Ÿé…ç½®**: macOS, æ–‡ä»¶æè¿°ç¬¦é™åˆ¶: 65,536

### è¯¦ç»†Benchmarkç»“æœ

**æµ‹è¯•å‘½ä»¤**:
```bash
ulimit -n 65536 && ab -c 10000 -n 10000 http://127.0.0.1:9001/
```

**æµ‹è¯•ç»“æœ**:
```
Server Software:        X-Server
Server Hostname:        127.0.0.1
Server Port:            9001

Document Path:          /
Document Length:        3689 bytes

Concurrency Level:      10000
Time taken for tests:   2.238 seconds
Complete requests:      10000
Failed requests:        0
Total transferred:      38440000 bytes
HTML transferred:       36890000 bytes
Requests per second:    4468.66 [#/sec] (mean)
Time per request:       2237.808 [ms] (mean)
Time per request:       0.224 [ms] (mean, across all concurrent requests)
Transfer rate:          16774.93 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0  223 298.6    118    1823
Processing:    20   90  75.3     71     738
Waiting:        1   80  75.4     59     487
Total:         43  312 304.7    215    1884

Percentage of the requests served within a certain time (ms)
  50%    215
  66%    309
  75%    368
  80%    421
  90%    653
  95%   1068
  98%   1127
  99%   1785
 100%   1884 (longest request)
```

**æ€§èƒ½åˆ†æ**:
- âœ… **é›¶å¤±è´¥ç‡**: 10,000ä¸ªè¯·æ±‚å…¨éƒ¨æˆåŠŸå¤„ç†
- âœ… **é«˜å¹¶å‘**: æ”¯æŒ10,000å¹¶å‘è¿æ¥ç¨³å®šè¿è¡Œ
- âœ… **é«˜åå**: 4,468 RPSçš„è¯·æ±‚å¤„ç†èƒ½åŠ›
- âœ… **ä½å»¶è¿Ÿ**: 50%è¯·æ±‚åœ¨215mså†…å®Œæˆ
- âœ… **é«˜ä¼ è¾“**: 16.7MB/sçš„æ•°æ®ä¼ è¾“é€Ÿç‡

### æ€§èƒ½å¯¹æ¯”

| æœåŠ¡å™¨ | å¹¶å‘è¿æ¥ | RPS | å¹³å‡å“åº”æ—¶é—´ | 99%å“åº”æ—¶é—´ | å†…å­˜ä½¿ç”¨ |
|--------|----------|-----|--------------|-------------|----------|
| **X-Server** | 10,000 | **4,468** | **223ms** | **1,785ms** | ä½ |
| Nginx | 10,000 | ~5,000 | ~200ms | ~1,500ms | ä¸­ç­‰ |
| Apache | 10,000 | ~2,000 | ~500ms | ~3,000ms | é«˜ |
| Node.js | 10,000 | ~3,000 | ~333ms | ~2,500ms | ä¸­ç­‰ |

**ä¼˜åŠ¿åˆ†æ**:
- ğŸš€ **é«˜æ€§èƒ½**: æ¥è¿‘Nginxçš„æ€§èƒ½æ°´å¹³
- ğŸ’¾ **ä½å†…å­˜**: ç›¸æ¯”Apacheå’ŒNode.jsæ›´ä½çš„å†…å­˜å ç”¨
- ğŸ”§ **æ˜“éƒ¨ç½²**: å•äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ— ä¾èµ–
- ğŸ›¡ï¸ **é«˜ç¨³å®š**: å¤šè¿›ç¨‹æ¶æ„ï¼Œè¿›ç¨‹éš”ç¦»

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

**ç³»ç»Ÿçº§ä¼˜åŒ–**:
```bash
# å¢åŠ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
ulimit -n 65536

# ä¼˜åŒ–ç½‘ç»œå‚æ•°
echo 'net.core.somaxconn = 65535' >> /etc/sysctl.conf
echo 'net.ipv4.tcp_max_syn_backlog = 65535' >> /etc/sysctl.conf
sysctl -p

# ä¼˜åŒ–è¿›ç¨‹é™åˆ¶
echo '* soft nofile 65536' >> /etc/security/limits.conf
echo '* hard nofile 65536' >> /etc/security/limits.conf
```

**X-Serveré…ç½®ä¼˜åŒ–**:
```nginx
# é«˜æ€§èƒ½é…ç½®ç¤ºä¾‹
worker_processes auto;              # è‡ªåŠ¨æ£€æµ‹CPUæ ¸å¿ƒæ•°
worker_connections 10000;           # æ¯ä¸ªWorkeræœ€å¤§è¿æ¥æ•°
worker_rlimit_nofile 65535;         # æ–‡ä»¶æè¿°ç¬¦é™åˆ¶

# ç½‘ç»œä¼˜åŒ–
tcp_nodelay on;                     # ç¦ç”¨Nagleç®—æ³•
keepalive_timeout 65;               # Keep-aliveè¶…æ—¶

# å†…å­˜ä¼˜åŒ–
memory_pool_size 100m;              # å†…å­˜æ± å¤§å°
connection_pool_size 1000;          # è¿æ¥æ± å¤§å°
```

**ç›‘æ§æŒ‡æ ‡**:
- ğŸ“Š **QPS**: ç›®æ ‡ > 5,000 RPS
- â±ï¸ **å“åº”æ—¶é—´**: ç›®æ ‡ < 200ms (å¹³å‡)
- ğŸ”— **å¹¶å‘è¿æ¥**: ç›®æ ‡ > 10,000
- ğŸ’¾ **å†…å­˜ä½¿ç”¨**: ç›‘æ§å†…å­˜æ³„æ¼
- ğŸš¨ **é”™è¯¯ç‡**: ç›®æ ‡ < 0.1%

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### è¿›ç¨‹æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Master Process                        â”‚
â”‚  âœ… é…ç½®ç®¡ç†    âœ… Workerè¿›ç¨‹ç®¡ç†   âœ… ä¿¡å·å¤„ç†        â”‚
â”‚  âœ… çƒ­é‡è½½      âœ… è¿›ç¨‹ç›‘æ§         âœ… ä¼˜é›…å…³é—­        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ fork() + å…±äº«å†…å­˜é€šä¿¡
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚                 â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚Worker 1â”‚      â”‚Worker 2â”‚ ...  â”‚Worker Nâ”‚
â”‚äº‹ä»¶å¾ªç¯â”‚      â”‚äº‹ä»¶å¾ªç¯â”‚      â”‚äº‹ä»¶å¾ªç¯â”‚
â”‚HTTPå¤„ç†â”‚      â”‚HTTPå¤„ç†â”‚      â”‚HTTPå¤„ç†â”‚
â”‚ä»£ç†è½¬å‘â”‚      â”‚ä»£ç†è½¬å‘â”‚      â”‚ä»£ç†è½¬å‘â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—æ¶æ„
```
åº”ç”¨å±‚: main.c - ç¨‹åºå…¥å£å’Œå‘½ä»¤è¡Œå¤„ç†
ç®¡ç†å±‚: master_process.c, worker_process.c, config.c
ä¸šåŠ¡å±‚: connection.c, http.c, proxy.c, file_handler.c, auth.c
ä¼˜åŒ–å±‚: event_loop.c, logger.c, memory_pool.c, connection_pool.c
ç³»ç»Ÿå±‚: shared_memory.c, process_title.c, config_validator.c
```

## ğŸ”§ å¼€å‘æŒ‡å—

### ä»£ç ç»“æ„
```
x-server/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.c # å¤šè¿›ç¨‹ç‰ˆæœ¬ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ master_process.c    # Masterè¿›ç¨‹ç®¡ç†
â”‚   â”œâ”€â”€ worker_process.c    # Workerè¿›ç¨‹å¤„ç†
â”‚   â”œâ”€â”€ event_loop.c        # ç»Ÿä¸€äº‹ä»¶å¾ªç¯
â”‚   â”œâ”€â”€ logger.c            # TLSä¼˜åŒ–æ—¥å¿—ç³»ç»Ÿ
â”‚   â””â”€â”€ ...
â”œâ”€â”€ include/                # å¤´æ–‡ä»¶ç›®å½•
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶ç›®å½•
â”œâ”€â”€ logs/                   # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ bin/                    # å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•
â””â”€â”€ obj/                    # ç¼–è¯‘å¯¹è±¡æ–‡ä»¶ç›®å½•
```

### ç¼–è¯‘ç³»ç»Ÿ
- **Makefile**: å®Œæ•´çš„ç¼–è¯‘ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§ç¼–è¯‘é€‰é¡¹
- **ä¾èµ–ç®¡ç†**: è‡ªåŠ¨ç”Ÿæˆä¾èµ–å…³ç³»ï¼Œå¢é‡ç¼–è¯‘
- **äº¤å‰ç¼–è¯‘**: æ”¯æŒä¸åŒå¹³å°çš„äº¤å‰ç¼–è¯‘
- **é™æ€åˆ†æ**: é›†æˆä»£ç è´¨é‡æ£€æŸ¥å·¥å…·

### è°ƒè¯•æ”¯æŒ
```bash
# ç¼–è¯‘è°ƒè¯•ç‰ˆæœ¬
make debug

# ä½¿ç”¨GDBè°ƒè¯•
gdb ./bin/x-server-mp
(gdb) set args -c config/gateway.conf
(gdb) run

# ä½¿ç”¨Valgrindæ£€æŸ¥å†…å­˜
valgrind --leak-check=full ./bin/x-server-mp -c config/gateway.conf
```

## ğŸ“ˆ ç›‘æ§ä¸è¿ç»´

### æ€§èƒ½ç›‘æ§
- **è¿›ç¨‹çŠ¶æ€**: Master/Workerè¿›ç¨‹ç›‘æ§
- **è¿æ¥ç»Ÿè®¡**: æ´»è·ƒè¿æ¥ã€æ€»è¿æ¥æ•°ã€è¿æ¥æ± ä½¿ç”¨ç‡
- **è¯·æ±‚ç»Ÿè®¡**: QPSã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- **èµ„æºä½¿ç”¨**: CPUã€å†…å­˜ã€æ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨æƒ…å†µ
- **æ—¥å¿—ç»Ÿè®¡**: æ—¥å¿—ååé‡ã€é”™è¯¯æ—¥å¿—ç»Ÿè®¡


## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒ
1. Fork é¡¹ç›®åˆ°ä½ çš„GitHubè´¦æˆ·
2. å…‹éš†ä½ çš„Forkåˆ°æœ¬åœ°
3. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/your-feature`
4. æäº¤æ›´æ”¹: `git commit -am 'Add some feature'`
5. æ¨é€åˆ°åˆ†æ”¯: `git push origin feature/your-feature`
6. åˆ›å»ºPull Request

### ä»£ç è§„èŒƒ
- ä½¿ç”¨C99æ ‡å‡†
- éµå¾ªLinuxå†…æ ¸ä»£ç é£æ ¼
- å‡½æ•°åä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•
- ç»“æ„ä½“ä½¿ç”¨_tåç¼€
- æ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£

### æµ‹è¯•è¦æ±‚
- æ‰€æœ‰æ–°åŠŸèƒ½å¿…é¡»åŒ…å«æµ‹è¯•ç”¨ä¾‹
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡: `make test`
- è¿›è¡Œå†…å­˜æ³„æ¼æ£€æŸ¥: `make valgrind`
- æ€§èƒ½å›å½’æµ‹è¯•: `make benchmark`

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢nginxé¡¹ç›®æä¾›çš„æ¶æ„è®¾è®¡çµæ„Ÿ
- æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…çš„åŠªåŠ›å’Œæ”¯æŒ
- æ„Ÿè°¢å¼€æºç¤¾åŒºçš„å®è´µå»ºè®®å’Œåé¦ˆ

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/your-repo/x-server
- **é—®é¢˜åé¦ˆ**: https://github.com/your-repo/x-server/issues
- **é‚®ç®±**: your-email@example.com
- **æ–‡æ¡£**: https://x-server.readthedocs.io/

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªStarï¼